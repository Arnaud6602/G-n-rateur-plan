<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G√©n√©rateur Plan Domotique Tuya</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6fb;
  margin:0;
  padding:15px;
}
h1,h2{color:#1e3c72;margin:5px 0;}
.card{
  background:white;
  border-radius:12px;
  padding:15px;
  margin:15px 0;
  box-shadow:0 3px 8px rgba(0,0,0,0.1);
}
.piece{
  display:grid;
  grid-template-columns: 1fr 80px 80px;
  gap:10px;
  margin-bottom:10px;
}
input{
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}
button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  background:#1e3c72;
  color:white;
  font-size:16px;
  margin-top:10px;
}
pre{
  background:#111;
  color:#0f0;
  padding:15px;
  border-radius:12px;
  overflow:auto;
  font-size:14px;
  white-space:pre-wrap;
}
</style>
</head>
<body>

<h1>üîß G√©n√©rateur Plan Domotique Tuya</h1>

<div class="card">
<h2>1Ô∏è‚É£ Configuration de la maison</h2>

<div id="pieces"></div>

<button onclick="addPiece()">‚ûï Ajouter une pi√®ce</button>
<button onclick="generate()">‚öôÔ∏è G√©n√©rer le plan complet</button>
</div>

<div class="card">
<h2>üìã Plan g√©n√©r√©</h2>
<pre id="result"></pre>
</div>

<script>
let count=0;

function addPiece(){
  count++;
  const div=document.createElement("div");
  div.className="piece";
  div.innerHTML=`
    <input placeholder="Nom de la pi√®ce" id="name${count}">
    <input type="number" placeholder="Volets" id="v${count}" min="0">
    <input type="number" placeholder="Baies" id="b${count}" min="0">
  `;
  document.getElementById("pieces").appendChild(div);
}

function generate(){
  let txt="";
  let openNormal=[];
  let closeNormal=[];
  let closeAll=[];
  let openVacances=[];
  let closeVacances=[];

  txt+="SC√àNES TECHNIQUES (non visibles client)\n\n";

  let id=1;

  for(let i=1;i<=count;i++){
    const name=document.getElementById("name"+i).value || "Piece"+i;
    const v=parseInt(document.getElementById("v"+i).value)||0;
    const b=parseInt(document.getElementById("b"+i).value)||0;

    // Volets
    for(let j=1;j<=v;j++){
      const openName=`O${id} ‚Äî ${name} Volet ${j}`;
      const closeName=`F${id} ‚Äî ${name} Volet ${j}`;
      txt+=`${openName}\n${closeName}\n\n`;

      openNormal.push(`O${id}`);
      closeNormal.push(`F${id}`);
      closeAll.push(`F${id}`);
      openVacances.push(`O${id}`);
      closeVacances.push(`F${id}`);
      id++;
    }

    // Baies
    for(let k=1;k<=b;k++){
      const openBaie=`OBV${id} ‚Äî ${name} Baie`;
      const closeBaie=`FBV${id} ‚Äî ${name} Baie`;
      txt+=`${openBaie}\n${closeBaie}\n\n`;

      openVacances.push(`OBV${id}`);
      closeVacances.push(`FBV${id}`);
      closeAll.push(`FBV${id}`);
      id++;
    }
  }

  txt+="==============================\n\n";

  txt+="NOMMAGE DES √âQUIPEMENTS DANS TUYA\n\n";
  for(let i=1;i<=count;i++){
    const name=document.getElementById("name"+i).value || "Piece"+i;
    const v=parseInt(document.getElementById("v"+i).value)||0;
    const b=parseInt(document.getElementById("b"+i).value)||0;
    for(let j=1;j<=v;j++){
      txt+=`‚Ä¢ ${name} Volet ${j}\n`;
    }
    for(let k=1;k<=b;k++){
      txt+=`‚Ä¢ ${name} Baie ${k}\n`;
    }
  }

  txt+="\n==============================\n\n";

  txt+="SC√àNES CLIENT (boutons visibles)\n\n";
  txt+="MODE ‚Äî Normal\nMODE ‚Äî Vacances\nMODE ‚Äî Nuit / Je pars\n\n";

  txt+="==============================\n\n";

  // MODE NORMAL
  txt+="MODE ‚Äî Normal\n\n";
  txt+="Automatisations :\n";
  txt+=`‚Ä¢ Lever du soleil ‚Üí ${openNormal.join(", ")}\n`;
  txt+=`‚Ä¢ Coucher du soleil ‚Üí ${closeNormal.join(", ")} (sauf baie)\n\n`;

  txt+="------------------------------\n\n";

  // MODE VACANCES
  txt+="MODE ‚Äî Vacances\n\n";
  txt+="Automatisations :\n";
  txt+=`‚Ä¢ Lever du soleil ‚Üí ${openVacances.join(", ")}\n`;
  txt+=`‚Ä¢ Coucher du soleil ‚Üí ${closeVacances.join(", ")}\n\n`;

  txt+="------------------------------\n\n";

  // MODE NUIT / JE PARS
  txt+="MODE ‚Äî Nuit / Je pars\n\n";
  txt+="Sc√®ne visible : MODE ‚Äî Nuit / Je pars\n\n";
  txt+="Automatisations :\n";
  txt+=`‚Ä¢ Si sc√®ne activ√©e ‚Üí ${closeAll.join(", ")} (fermeture imm√©diate totale, volets + baie)\n`;
  txt+="‚Ä¢ √Ä 00:05 ‚Üí Activer MODE ‚Äî Normal (retour automatique le lendemain)\n";

  document.getElementById("result").textContent=txt;
}
</script>

</body>
</html>